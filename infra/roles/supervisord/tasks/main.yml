- name: install python-setuptools
  apt: name=python-setuptools

- name: Install pip
  easy_install: name=pip

- name: PyPI packages to run a site
  pip: name={{ item }} state=latest
  with_items:
    - supervisor

- name: create config folder
  file:
    dest: /etc/supervisor
    state: directory
    owner: root

- name: create config
  template:
    src: templates/supervisord.conf
    dest: /etc/supervisor/supervisord.conf

- name: create init script
  template:
    src: templates/supervisord.sh
    dest: /etc/init.d/supervisord
    mode: 0755

- name: start service
  service:
    name: supervisord
    state: started
    enabled: yes
